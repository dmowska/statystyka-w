{
  "hash": "f77f0b9711b844a47a472a0b329f0be2",
  "result": {
    "markdown": "# Rozkłady danych\n\n## Podstawowe pojęcia\n\n### Zmienne losowe\n\nZmienna losowa (ang. *random variables*) to wartość liczbowa, której wynik zależy od losu. Prawdopodobieństwo uzyskania danej wartości zależy od *gęstości prawdopodobieństwa* danej zmiennej $p(x)$ (lub $f(x)$).\n\n-   Zmienne dyskretne\n\n    -   Zmienne dyskretne przyjmują konkretną wartość liczbową (zliczenie)\n    -   Przykładem zmiennych dyskretnych jest rzut monetą albo rzut kostką\n\n-   Zmienne ciągłe\n\n    -   zmienna ciągła może przyjmować wszystkie wartości z określonego przedziału liczbowego\n    -   Przykładem zmiennych ciągłych jest wzrost, temperatura\n\n## Rozkłady zmiennych losowych\n\nRozkłady zmiennych losowych można podzielić na:\n\n-   rozkłady dyskretne\n-   rozkłady ciągłe\n-   ani dyskretne, ani ciągłe.\n\nRozkłady można także podzielić na **rozkłady teoretyczne** (tj. oparte o pewne założenia) oraz **rozkłady empiryczne** (tj. rozkład wartości oparty o obserwowane dane).\n\n### Rozkłady dyskretne\n\n-   Bernoulliego (zero-jedynkowy)\n-   Dwumianowy\n-   Poissona\n-   Geometryczny\n-   Hipergeometryczny\n\n### Rozkłady ciągłe\n\n-   Normalny\n-   t-Studenta\n-   Chi-kwadrat\n-   Fishera\n\n## Rozkłady danych w R\n\nDla każdego rozkładu danych dostępnego w R istnieją cztery funkcje, rozpoczynające się od kolejnych liter:\n\n-   *d* - zwraca wartość funkcji gęstości rozkładu (pdf - probability density function)\n-   *p* - zwraca wartości dystrybuanty\n-   *q* - podaje jaki kwantyl znajduje się po lewej stronie wykresu gęstości\n-   *r* - zwraca losowo wygenerowane wartości z danego rozkładu\n\n\n::: {.cell}\n\n```{.r .cell-code}\n?Distributions\n```\n:::\n\n\nwiecej informacji: <https://github.com/bearloga/tinydensR>\n\n## Rozkład normalny\n\n-   Zwany inaczej rozkładem Gaussa.\n-   Opisywany jest za pomocą dwóch parametrów: średniej $\\mu$ oraz wariancji $\\sigma^2$ (odchylenie standardowe rozkładu jest określane przez $\\sigma$).\n-   Opisuje on sytuacje, gdy większość przypadków ma wartość zbliżoną do średniej, a im wartość jest dalsza od średniej tym jest ich coraz mniej.\n-   Jeden z najważniejszych rozkładów prawdopodobieństwa, odgrywający ważną rolę w statystyce. Wykres funkcji prawdopodobieństwa tego rozkładu jest krzwą w kształcie dzwonu.\n-   Znacenie tego rozkładu wynika z faktu, że często jest on obserwowany w naturze. Obserwacja wielu zjawisk przyrodniczych pozwoliła stwierdzić, że podlegają one prawu rozkładu normalnego lub bardzo zbliżonego do niego.\n\nRozkład normalny o średniej równej 0 a odchyleniu standardowym równym 1 nazywamy *standaryzowanym rozkładem normalnym* i oznaczamy N(0,1).\n\n### Reguła trzech sigm\n\n-   We wszystkich rozkładach normalnych funkcja gęstości jest symetryczna względem wartości średniej rozkładu.\n\n-   Prawdopodobieństwo, że wartość zmiennej znajduje się w odległości nie większej (lub mniejszej):\n\n    -   niż jedno odchylenie standardowe od średniej wynosi 68.3%;\n    -   niż dwa odchylenia standardowe od średniejwynosi 95.5%;\n    -   niż trzy odchylenia standardowe od średniej wynosi 99.7%.\n\n![Ilutracja reguły trzech sigm](figures/6_normalny.png){width=\"487\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrnorm(n = 10, mean = 0, sd = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1]  0.3064756  1.0345122  1.8868512  0.4347006 -0.1538958  0.2652002\n [7]  0.7139269  0.4466803 -0.3225711  0.7118515\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(rnorm(n = 10000, mean = 0, sd = 1))\n```\n\n::: {.cell-output-display}\n![](5_rozklady_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell fig_width='400px'}\n\n```{.r .cell-code}\ncurve(dnorm(x, mean = 0, sd = 1), xlim = c(-5, 5))\nabline(h = 0)\n```\n\n::: {.cell-output-display}\n![](5_rozklady_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Probability of having a value *lower* than 90 in a normal distribution with a mean of 120 and sd of 20.\npnorm(q = 90, mean = 120, sd = 20, lower.tail = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.0668072\n```\n:::\n:::\n\n::: {.cell fig_width='400px'}\n::: {.cell-output-display}\n![](5_rozklady_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## X-axis value *below* which the probability is 6%\nqnorm(p = 0.0668072, mean = 120, sd = 20, lower.tail = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 90\n```\n:::\n:::\n\n::: {.cell fig_width='400px'}\n::: {.cell-output-display}\n![](5_rozklady_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n**Przykład**: Załóżmy, że wyniki z egzaminów wstępnych mają rozkład normalny, ze średnią 72 punktów oraz odchyleniem standardowym 15.2 Jaki procent studentów uzyska wynik 84 lub wyższy na egzaminie?\n\n\n::: {.cell}\n\n```{.r .cell-code}\npnorm(84, mean=72, sd=15.2, lower.tail=FALSE) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2149176\n```\n:::\n:::\n\n\nOdpowiedź: Procent studentów z wynikiem 84 punkty lub większym wynosi 21,5%\n\n### Test Shapiro-Wilka\n\n-   służy do sprawdzenia czy analizowna zmienna ma rozkład zbliżony do rozkładu normalnego.\n-   hipoteza zerowa testu: rozkład analizowanej zmiennej jest zbliżony do rozkładu normalnego.\n-   istotny wynik testu Shapiro-Wilka ([***p-value \\<0.05***]{.underline}) świadczy o tym, że rozkład zmiennej obserwowanej [**nie jest podobny**]{.underline} do rozkładu normalnego\n-   w R obliczany za pomocą `shapiro.test()`\n-   testowanie normalności rozkładu jest wymagane przy użyciu testów parametrycznych, np: testy t-Studenta, analiza wariancji, etc.\n-   Alternatywą do testowania normalności rozkładu jest test Kołmogorowa-Smirnowa\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123456)\nx <- rnorm(1000, mean = 10, sd = 2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(x)\n```\n\n::: {.cell-output-display}\n![](5_rozklady_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(x)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  x\nW = 0.99881, p-value = 0.7595\n```\n:::\n:::\n\n\nWartość p-value wynosi p-value = 0.7595 (jest większa od 0.05), zatem powyższy rozkład jest zbliżony rozkładu normalnego.\n\n> Ze zbioru danych gapminder wyselekcjonować dane dla kontynentu Afryka. Wykonać histogram dla zmiennej lifeExp oraz test Shapiro-Wilka. Czy zmienna lifeExp dla kontynentu Afryka ma rozkład zbiżony do rozkładu normalnego?\n\n## Rozkład t-Studenta\n\n-   Rozkład t-Studenta powstaje podczas pobierania próbek z populacji o rozkładzie normalnym, gdy wielkość próby jest mała, a odchylenie standardowe populacji jest nieznane.\n-   Stosowany do estymacji średniej z populacji o rozkładzie normalnych w sytuacji, gdy wielkość próby jest niewielka a odchylenie standardowe populacji jest nieznane.\n-   Rozkład ten zależy tylko od jednego parametru - liczby stopni swobody (parametrt $df$). Im więcej stopni swobody, tym rozkład bardziej zbliżony do rozkładu normalnego.\n-   Rozkład t-Studenta jest symetryczny, dzwonowaty podobnie jak rozkład normalny, ale posiada więcej wartości dalej od średniej (tj. w pobliżu ogona)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrt(10, df=1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1]    0.92297916   -0.20165942    0.08419619   -0.80070298   -0.81496737\n [6]    2.80093963    1.11345374   -1.46005179 -200.42356127    1.61274179\n```\n:::\n:::\n\n::: {.cell fig_width='400px'}\n::: {.cell-output-display}\n![](5_rozklady_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n## Rozkłady empiryczne\n\nRozkład empiryczny - rozkład wartości oparty o obserwowane dane. Najczęściej jest przedstawiany za pomocą histogramu.\n\n![](figures/6_rozklad.png){width=\"458\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"gapminder\", package = \"gapminder\")\nlibrary(ggplot2)\n```\n:::\n\n\n### Histogram\n\n-   **Rozkład oczekiwanej długości trwania życia**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = gapminder, aes(x = lifeExp)) + geom_histogram(binwidth = 2) + theme_bw()\n```\n\n::: {.cell-output-display}\n![](5_rozklady_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n> Określ jaki rozkład ma oczekiwana długość trwania życia: symetryczny/asymetryczny lewostronnie/asymetryczny prawostronnie, jednomodalny/dwumodalny/wielomodalny?\n\n-   **Rozkład produktu krajowego brutto (gdpPercap)**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = gapminder, aes(x = gdpPercap)) + geom_histogram(binwidth=10000) + theme_bw()\n```\n\n::: {.cell-output-display}\n![](5_rozklady_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n> Określ jaki rozkład ma produkt krajowy brutto: symetryczny/asymetryczny lewostronnie/asymetryczny prawostronnie, jednomodalny/dwumodalny/wielomodalny?\n\n> Wykonaj histogram dla zmiennej gdpPercap, ustaw szerokość przedziałów na 5000 (binwidth = 5000) Jaki rozkład ma zmienna gdpPercap?\n\n> Wykonaj histogram dla zmiennej pop. Określ jaki rozkład ma zmienna pop: symetryczny/asymetryczny lewostronnie/asymetryczny prawostronnie, jednomodalny/dwumodalny/wielomodalny?\n\n-   **Rozkład oczekiwanej długości trwania życia (lifeExp) według kontynentów**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(gapminder, aes(x = lifeExp)) + \n  geom_histogram() + \n  facet_wrap(~continent, ncol = 3) + \n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](5_rozklady_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n> Określ jaki rozkład ma oczekiwana długość trwania życia na poszczególnych kontynentach: symetryczny/asymetryczny lewostronnie/asymetryczny prawostronnie, jednomodalny/dwumodalny/wielomodalny?\n\n> Wykonaj histogram dla zmiennej gdpPercap w podziale na kontynenty.\n\n### Wykres pudełkowy\n\nWykres pudełkowy poza wizaulizacją statystyk opisowych pozwala także na określenie typu rozkładu danych (symetryczny, asymetryczny).\n\n### Rozkład danych, a wykres pudełkowy.\n\n![](figures/6_rozklad_box.png)\n\n-   **Rozkład symetryczny**\n\n    -   mediana wypada na środku pudełka,\n    -   wąsy równej długości po obu stronach pudełka\n\n-   **Rozkład asymetryczny lewostronnie**\n\n    -   mediana wypada bliżej górnej krawędzi pudełka,\n    -   mediana \\> średnia\n    -   wąsy wychodzące z dolnej krawędzi pudełka są dłuższe.\n\n-   **Rozkład asymetryczny prawostronnie**\n\n    -   mediana wypada bliżej dolnej krawędzi pudełka,\n    -   mediana \\< średnia\n    -   wąsy wychodzące z górnej krawędzi pudełka są dłuższe.\n\n![](figures/6_rozklad_box_2.png){width=\"353\"}\n\n**Wykres pudełkowy dla oczekiwanej długości trwania życia według kontynentów**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = gapminder, aes(x = continent, y = lifeExp)) + \n  geom_boxplot() + \n  stat_summary(fun = mean, geom=\"point\", shape=20, size=4) +\n  labs(x = \"Kontynent\", \n       y = \"Oczekiwana długość trwania życia\", \n       title = \"Zróżnicowanie oczekiwanej długości trwania życia na kontynentach\") + \n  theme_bw() \n```\n\n::: {.cell-output-display}\n![](5_rozklady_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n> Proszę wykonać wykres pudełkowy przedstawiający rozkład wartości gdpPercap według kontynentów. Jak określisz rozkłady danych na poszczególnych kontynentach?\n\n## Miary asymetrii i koncentracji\n\n### Miary asymetrii\n\nAsymetrię rozkładu określa się za pomocą skośności.\n\n-   skośność = 0 - rozkład symetryczny\n-   skośność \\< 0 - rozkład asymetryczny lewostronnie (rozkład ma dłuższy lewy ogon)\n-   skośność \\> 0 - rozkład asymetryczny prawostronnie (rozkład ma dłuższy prawy ogon)\n\n![](figures/6_asymetria.png)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(e1071)\nskewness(gapminder$lifeExp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.2522575\n```\n:::\n:::\n\n\n### Miary koncentracji\n\nMiary koncentracji opisują koncentrację wartości cechy wokół średniej. Jedną z miar koncentracji jest kurtoza.\n\n-   K \\> 0 - Im wyższa kurtoza, tym bardziej wysmukła jest krzywa liczebności,a zatem większa koncentracja wokół średniej\n-   K \\< 0 - rozkład bardziej spłaszczony niż rozkład normalny.\n\n![](figures/6_koncentracja.png)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(e1071)\nkurtosis(gapminder$lifeExp)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -1.129098\n```\n:::\n:::\n\n\n> Oblicz skośność oraz kurtozę dla zmiennej gdpPercap w zbiorze danych gapminder. \n\n## Porównanie rozkładów\n\nW statystyce wykres kwantylowy (QQ-plot) jest wykresem prawdopodobieństwa, który porównuje (w graficzny sposób) 2 rozkłady prawdopodobieństwa przez wykreślenie ich kwantyli na przeciwnych osiach (x,y). Jeśli 2 porównywane rozkłady są podobne, punkty na wykresie kwantylowym ułożą się wzdłuż linii y=x Wykres normalności (Norm QQ Plot) porównuje rozkład próbki z rozkładem normalnym.\n\nW R wykresy te można wykreślić używając funkcji `qqplot()` oraz `qqnorm()` z grafiki podstawowej. Wykonując wykres za pomocą pakietu `ggplot2` należy dodać geometrię `geom_qq`.\n\n**Porównanie rozkładu zmiennej lifeExp dla kontynentu Afryka z rozkładem teoretycznym**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#wyselekcjonować dane dla kontynentu Afryka dotyczące średniej długości trwania życia\ndane_Africa <- gapminder[gapminder$continent == 'Africa',]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = dane_Africa, aes(sample = lifeExp)) + stat_qq()\n```\n\n::: {.cell-output-display}\n![](5_rozklady_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n## Dodatkowe materiały\n\n- Obliczanie prawdopodobieństwa z rozkładów\n\n<https://gallery.shinyapps.io/dist_calc/>\n\n- Ilustracja wykresu kwantylowego\n\n<https://xiongge.shinyapps.io/QQplots/>\n",
    "supporting": [
      "5_rozklady_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}