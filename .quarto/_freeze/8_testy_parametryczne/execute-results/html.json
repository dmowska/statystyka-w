{
  "hash": "373f5993002d879428153f930ae5198d",
  "result": {
    "markdown": "# Testy parametryczne\n\n## Testy t-Studenta\n\n-   Służą do wnioskowania o wartości średniej w populacji, z której pobraliśmy próbę losową.\n\n-   Służą do porównania ze sobą dwóch grup\n\n-   Można wyróżnić trzy rodzaje testów t-Studenta:\n\n    -   dla prób niezależnych\n    -   dla prób zależnych\n    -   dla jednej próby\n\n-   Założenia testów t-Studenta\n\n    -   Rozkład danych obserwacji jest zbliżony do rozkładu normalnego\n    -   Badane grupy mają zbliżoną liczebność\n    -   Wartości w badanych grupach wykazują podobną wariancję (homogeniczność wariancji)\n    -   Zmienne powinny być ilościowe\n\n-   Hipoteza statystyczna\n\n    -   Hipoteza zerowa: $H_0 : \\mu_1 = \\mu_2$\n\n    -   Hipotezy alternatywne:\n\n        -   test jednostronny: $H_A : \\mu_1 > \\mu_2$\n        -   test dwustronny: $H_A : \\mu_1 \\neq \\mu_2$\n\n\n### Test t-Studenta dla prób niezależnych\n\n-   Dotyczy porównania ze sobą dwóch różnych grup obserwacji\n-   Próby muszą być od siebie niezależne (wyniki pomiaru jednej grupy nie zależą od wyników pomiaru drugiej grupy)\n\n**Przykład: Czy istnieją istotne różnice w średniej temperaturze (annual_tavg) między Niżem Wschodniobałtycko-Białoruskim, a Wyżynami Polskimi?**\n\n\n::: {.cell}\n\n```{.r .cell-code}\npomiary_pol = read.csv(\"data/pomiary_pol.csv\")\npomiary_pol2 = subset(pomiary_pol, \n                      prowincja %in%\n                       c(\"Niż Wschodniobałtycko-Białoruski\",\n                         \"Wyżyny Polskie\"))\nhead(pomiary_pol2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   pomiar_id   tmin_4   tmax_4   tmin_9   tmax_9 annual_tavg annual_precip\n2          2 4.122184 14.35588 9.214639 19.32696    8.144152      644.7503\n8          8 2.656403 12.32077 8.042327 17.45611    6.614168      625.5083\n20        20 3.528041 13.42039 8.415737 18.41839    7.387148      544.4395\n22        22 3.636560 13.50256 8.553030 18.40303    7.309585      562.4307\n24        24 4.297906 14.19705 9.064549 18.89787    7.654198      539.5709\n29        29 2.769288 12.26086 8.207968 17.51594    6.660865      591.5201\n   prow_id woj_id                        prowincja    wojewodztwo\n2        6     13                   Wyżyny Polskie świętokrzyskie\n8        6      9                   Wyżyny Polskie   podkarpackie\n20       6      3                   Wyżyny Polskie      lubelskie\n22       6      3                   Wyżyny Polskie      lubelskie\n24       6      3                   Wyżyny Polskie      lubelskie\n29       5     10 Niż Wschodniobałtycko-Białoruski      podlaskie\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nggplot(pomiary_pol2, aes(x = prowincja, y = annual_tavg)) + \n  geom_boxplot() + \n  labs(x = \"Prowincja\", y = \"Temperatura powietrza [C]\") + \n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](8_testy_parametryczne_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nTestowanie istotności różnic przy założeniu hipotezy dwustronnej tj. $\\mu_{Niż} \\neq \\mu_{Wyżyny}$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(annual_tavg ~ prowincja, data = pomiary_pol2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  annual_tavg by prowincja\nt = -13.475, df = 338.76, p-value < 2.2e-16\nalternative hypothesis: true difference in means between group Niż Wschodniobałtycko-Białoruski and group Wyżyny Polskie is not equal to 0\n95 percent confidence interval:\n -0.7378497 -0.5498738\nsample estimates:\nmean in group Niż Wschodniobałtycko-Białoruski \n                                      6.979376 \n                  mean in group Wyżyny Polskie \n                                      7.623238 \n```\n:::\n:::\n\n\n**Intepretacja wyników**\n\n-   Poziom prawdopodobieństwa p (p-wartość) - jest to wyliczany w pakietach komputerowych najmniejszy poziom istotności, przy której wyliczona wartość testującej statystyki doprowadza do odrzucenia hipotezy zerowej.\n\n-   ***Jeśli p-wartość jest poniżej założonego poziomu istotności (np. 0.05) tzn. że hipotezę zerową możemy odrzucić na rzecz hipotezy alternatywnej.***\n\nW powyższym przykładzie:\n\n-   Hipoteza zerowa: prawdziwa różnica w średnich jest równa 0\n\n-   Hipoteza alternatywna: Prawdziwa róznica w średnich nie jest równa 0.\n\n-   P-wartość \\< 2.2e-16\n\n    -   P-wartość jest mniejsza od 0.05 a zatem możemy odrzucić hipotezę zerową (różnica w średnich równa 0) na rzecz hipotezy alternatywnej (różnica w średnich różna od 0)\n\n-   ***Pytanie: Czy średnia temperatura powietrza na Niżu i na Wyżynach różni się istotnie?***\n\n-   ***Odpowiedź: Średnia temperatura na Niżu i na Wyżynach różni się istotnie.***\n\n**Przykład: Czy średnia temperatura (annual_tavg) Niżu Wschodniobałtycko-Białoruskiego jest istotnie wyższa od tempratury na Wyżynach Polskich?**\n\nTestowanie istotności różnic przy założeniu hipotezy jednostronnej tj. $\\mu_{Niż} > \\mu_{Wyżyny}$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(annual_tavg ~ prowincja, data = pomiary_pol2, \n       alternative = \"greater\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  annual_tavg by prowincja\nt = -13.475, df = 338.76, p-value = 1\nalternative hypothesis: true difference in means between group Niż Wschodniobałtycko-Białoruski and group Wyżyny Polskie is greater than 0\n95 percent confidence interval:\n -0.7226726        Inf\nsample estimates:\nmean in group Niż Wschodniobałtycko-Białoruski \n                                      6.979376 \n                  mean in group Wyżyny Polskie \n                                      7.623238 \n```\n:::\n:::\n\n\n> Jaka jest interpretacja powyższego wyniku testu?\n\n**Przykład: Czy średnia temperatura (annual_tavg) Niżu Wschodniobałtycko-Białoruskiego jest istotnie niższa od tempratury na Wyżynach Polskich?**\n\nTestowanie istotności różnic przy założeniu hipotezy jednostronnej tj. $\\mu_{Niż} < \\mu_{Wyżyny}$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(annual_tavg ~ prowincja, data = pomiary_pol2, \n       alternative = \"less\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  annual_tavg by prowincja\nt = -13.475, df = 338.76, p-value < 2.2e-16\nalternative hypothesis: true difference in means between group Niż Wschodniobałtycko-Białoruski and group Wyżyny Polskie is less than 0\n95 percent confidence interval:\n       -Inf -0.5650509\nsample estimates:\nmean in group Niż Wschodniobałtycko-Białoruski \n                                      6.979376 \n                  mean in group Wyżyny Polskie \n                                      7.623238 \n```\n:::\n:::\n\n\n> Jaka jest interpretacja powyższego wyniku testu?\n\n> Wykorzystując dane w pliku pomiary_pol.csv sprawdź czy średnia temperatura roczna (annual_tavg) na Wyżynach Polskich różni się od Masywu Czeskiego? Stwórz wykres porównujący tą zmienną dla tych prowincji. Określ czy różnica pomiędzy średnimi jest istotna statystycznie.\n\n### Test t-Studenta dla prób zależnych\n\n-   Dotyczy porównania ze sobą tej samej grupy obserwacji\n-   Próby są zależne, czyli wynik pomiary w drugim badaniu zależy od pierwszego (dotyczy tej samej obserwacji)\n-   Służy określeniu wielkości zmian pomiędzy pomiarami\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyr)\nlibrary(ggplot2)\npomiary_pol = read.csv(\"data/pomiary_pol.csv\")\nhead(pomiary_pol)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  pomiar_id   tmin_4   tmax_4   tmin_9   tmax_9 annual_tavg annual_precip\n1         1 1.796358 12.04034 6.947685 17.84769    6.533702      864.6408\n2         2 4.122184 14.35588 9.214639 19.32696    8.144152      644.7503\n3         3 3.750375 12.58249 9.513398 17.76400    7.831449      613.0326\n4         4 3.645718 12.19533 9.743287 17.69533    7.851240      638.0846\n5         5 2.788949 12.58895 7.988949 17.78588    7.296935      546.1904\n6         6 4.129882 14.12988 9.300000 19.10000    8.200000      555.2842\n  prow_id woj_id                                              prowincja\n1       2      6 Karpaty Zachodnie z Podkarpaciem Zachodnim i Północnym\n2       6     13                                         Wyżyny Polskie\n3       4     16                                 Niż Środkowoeuropejski\n4       4     16                                 Niż Środkowoeuropejski\n5       4      3                                 Niż Środkowoeuropejski\n6       2      9 Karpaty Zachodnie z Podkarpaciem Zachodnim i Północnym\n         wojewodztwo\n1        małopolskie\n2     świętokrzyskie\n3 zachodniopomorskie\n4 zachodniopomorskie\n5          lubelskie\n6       podkarpackie\n```\n:::\n:::\n\n\n**Przykład: Czy maksymalna temperatura kwietnia (tmax_4) oraz września (tmax_9) różni się istotnie?**\n\n\n::: {.cell}\n\n```{.r .cell-code}\npomiary_pol_l <- pomiary_pol %>% \n  select(pomiar_id, tmax_4, tmax_9) %>% \n  pivot_longer(contains(\"tmax\"))\n\nggplot(pomiary_pol_l, aes(name, value)) + \n  geom_boxplot() + \n  labs(y = \"Temperatura powietrza [C]\") + \n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](8_testy_parametryczne_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nTest t-Studenta dla prób zależnych, jeśli dane są w formacie szerokim.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(pomiary_pol$tmax_4, pomiary_pol$tmax_9, paired = TRUE, alternative = \"greater\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPaired t-test\n\ndata:  pomiary_pol$tmax_4 and pomiary_pol$tmax_9\nt = -528.83, df = 1494, p-value = 1\nalternative hypothesis: true mean difference is greater than 0\n95 percent confidence interval:\n -5.26396      Inf\nsample estimates:\nmean difference \n      -5.247628 \n```\n:::\n:::\n\n\nTest t-Studenta dla prób zależnych, jeśli dane są w formacie długim.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(value ~ name, data = pomiary_pol_l, paired = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPaired t-test\n\ndata:  value by name\nt = -528.83, df = 1494, p-value < 2.2e-16\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n -5.267092 -5.228163\nsample estimates:\nmean difference \n      -5.247628 \n```\n:::\n:::\n\n\n> Jaka jest interpretacja powyższego wyniku?\n\n> Wykonaj test dla określenia czy maksymalna temperatura powietrza w kwietniu (tmax_4) jest niższa od maksymalnej temperatury września (tmax_9). Sformułuj hipotezę zerową oraz hipotezę alternatywną oraz zinterpretuj wynik testu.\n\n## Testowanie istotności różnic wariancji\n\n-   Pozwala na porównywanie wariancji w dwóch grupach pomiarów\n-   Zakłada rozkład normalny w obu grupach\n-   Test ten może być jednostronny lub dwustronny\n-   Dla wielu wariancji używany jest **test Levene'a**\n\n\n::: {.cell}\n\n```{.r .cell-code}\npomiary_pol = read.csv(\"data/pomiary_pol.csv\")\npomiary_pol2 = subset(pomiary_pol, \n                     prowincja %in%\n                       c(\"Niż Wschodniobałtycko-Białoruski\",\n                         \"Wyżyny Polskie\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nvar.test(annual_tavg ~ prowincja, data = pomiary_pol2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tF test to compare two variances\n\ndata:  annual_tavg by prowincja\nF = 0.8629, num df = 161, denom df = 178, p-value = 0.3405\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.6384037 1.1690499\nsample estimates:\nratio of variances \n         0.8628984 \n```\n:::\n:::\n\n\n**Interpretacja:**\n\n-   Wartość p-value dla testu F p = 0.3405 jest większa od założonego poziomu istotności (0.05). Nie ma istotnych różnic między wariancją dla obu grup (Niżu oraz Wyżyn).\n\n### Test Levene’a\n\n-   Porównywane grupy w testach parametrycznych powinny mieć podobne wariancje\n-   Do weryfikacji czy zachowana jest homogoniczność wariancji w grupach stosuje się, między innymi, test Levene\"a\n-   $H_0$ - wariancje są takie same\n-   $H_A$ - wariancje się różnią\n\n\n::: {.cell}\n\n```{.r .cell-code}\npomiary_pol = read.csv(\"data/pomiary_pol.csv\")\npomiary_pol2 = subset(pomiary_pol, \n                     prowincja %in%\n                       c(\"Niż Wschodniobałtycko-Białoruski\",\n                         \"Wyżyny Polskie\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\nleveneTest(annual_tavg ~ prowincja, data = pomiary_pol2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in leveneTest.default(y = y, group = group, ...): group coerced to\nfactor.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nLevene's Test for Homogeneity of Variance (center = median)\n       Df F value Pr(>F)\ngroup   1  1.2277 0.2686\n      339               \n```\n:::\n:::\n",
    "supporting": [
      "8_testy_parametryczne_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}